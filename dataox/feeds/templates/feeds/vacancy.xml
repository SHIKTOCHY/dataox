{% load humfrey_desc %}<?xml version="1.0"?>
<vacancies>{% for vacancy in vacancies %}
  <vacancy{% if vacancy.id %} id="{{ vacancy.id }}"{% endif %}>
    <uri>{{ vacancy.uri }}</uri>
    <url>{{ vacancy.url }}</url>{% if vacancy.webpage %}
    <webpage>{{ vacancy.webpage }}</webpage>{% endif %}{% if vacancy.label %}
    <label>{{ vacancy.label }}</label>{% endif %}{% if vacancy.opens %}
    <opens>{{ vacancy.opens }}</opens>{% endif %}{% if vacancy.closes %}
    <closes>{{ vacancy.closes }}</closes>{% endif %}{% if vacancy.location %}
    <location>{{ vacancy.location }}</location>{% endif %}{% if vacancy.html_description  %}
    <description format="application/xhtml+xml">{{ vacancy.html_description }}</description>{% endif %}{% if vacancy.text_description  %}
    <description format="text/plain">{{ vacancy.text_description }}</description>{% endif %}
    <organizationPart>{% with vacancy.organizationPart as orgPart %}
      <uri>{{ orgPart.uri }}</uri>
      <url>{{ orgPart.url }}</url>{% if orgPart.webpage %}
      <webpage>{{ orgPart.webpage }}</webpage>{% endif %}
      <label>{{ orgPart.label }}</label>{% with orgPart.address as adr %}{% if adr %}
      <address>{% if adr.streetAddress %}
        <street-address>{{ adr.streetAddress }}</street-address>{% endif %}{% if adr.extendedAddress %}
        <extended-address>{{ adr.extendedAddress }}</extended-address>{% endif %}{% if adr.locality %}
        <locality>{{ adr.locality }}</locality>{% endif %}{% if adr.postalCode %}
        <postal-code>{{ adr.postalCode }}</postal-code>{% endif %}
      </address>{% endif %}{% endwith %}
    {% endwith %}</organizationPart>{% with vacancy.basedNear as basedNear %}{% if basedNear %}
    <basedNear>
      <uri>{{ basedNear.uri }}</uri>
      <url>{{ basedNear.uri }}</url>
      <webpage>{{ basedNear.webpage }}</webpage>
      <label>{{ basedNear.label }}</label>{% with basedNear.address as adr %}{% if adr %}
      <address>{% if adr.streetAddress %}
        <street-address>{{ adr.streetAddress }}</street-address>{% endif %}{% if adr.extendedAddress %}
        <extended-address>{{ adr.extendedAddress }}</extended-address>{% endif %}{% if adr.locality %}
        <locality>{{ adr.locality }}</locality>{% endif %}{% if adr.postalCode %}
        <postal-code>{{ adr.postalCode }}</postal-code>{% endif %}
      </address>{% endif %}{% endwith %}{% if basedNear.location %}
      <location>
        <lat>{{ basedNear.location.lat }}</lat>
        <long>{{ basedNear.location.long }}</long>
      </location>{% endif %}
    </basedNear>{% endif %}{% endwith %}{% with vacancy.salary as salary %}{% if salary %}
    <salary>
      <label>{{ salary.label }}</label>{% if salary.grade %}
      <grade>{{ salary.grade }}</grade>{% endif %}{% if salary.lower %}
      <lower>{{ salary.lower }}</lower>{% endif %}{% if salary.upper %}
      <upper>{{ salary.upper }}</upper>{% endif %}{% if salary.currency %}
      <currency>{{ salary.currency }}</currency>{% endif %}
    </salary>{% endif %}{% endwith %}{% with vacancy.contact as contact %}{% if contact %}
    <contact>
      <label>{{ contact.label }}</label>{% if contact.email %}
      <email>{{ contact.email }}</email>{% endif %}{% if contact.tel.rdf_value %}
      <telephone>{{ contact.v_tel.rdf_value }}</telephone>{% endif %}
    </contact>{% endif %}{% endwith %}{% if vacancy.vacancy_furtherParticulars %}
    <document_urls>{% for document in vacancy.all.vacancy_furtherParticulars %}
      <document_url>{{ document.uri }}</document_url>{% endfor %}
    </document_urls>{% endif %}
  </vacancy>{% endfor %}
</vacancies>